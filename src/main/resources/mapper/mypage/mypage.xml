<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.haebub.dao.mypage.MypageMapper">
    <select id="lectureListDtos" parameterType="int" resultType="com.haebub.dto.mypage.LectureListDTO">
        SELECT
          ltitle
        , DATE(ptime) AS 'startDate'
        , DATE_ADD(DATE(ptime), INTERVAL+lperiod DAY) AS 'endDate'
        , tsubject
        , NAME
        , DATE(now()) AS 'now'
        FROM purchase p, lecture l, teacher t, user u
        <where>
                p.lid = l.lid
            AND l.tid = t.tid
            AND t.uid = u.uid
            AND p.uid = #{uid}
            AND DATE_ADD(DATE(ptime), INTERVAL+lperiod DAY) >= DATE(NOW())
        </where>
    </select>
</mapper>